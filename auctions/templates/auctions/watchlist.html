{% extends "auctions/layout.html" %}

{% block body %}
    <h2>&nbsp;&nbsp;My Watchlist</h2>

    <div class="row" id="container">
        {% for item in list %}
        <div class="list border">
            <div class="item-display">
                <div class="item-display-img">
                    <!-- Full natural-size preview -->
                    <div class="item-img">
                        <img src="{{ item.image }}">
                    </div>
                    <div class="image-preview">
                        <img src="{{ item.image }}" alt="image preview" />
                    </div>
                </div>
                <div class="item-bottom">
                    <h1>{{ item.title }}</h1>
                    {% with item.listingId.all|first as current %}
                        {% if current.amount == None %}
                            <p class="item-info">{% if not item.closeChecker %}
                                    Current 
                                {% else %}
                                    Final
                                {% endif %}   
                                price: &nbsp;<strong>No bid</strong></p>
                        {% else %}
                            <p class="item-info">{% if not item.closeChecker %}
                                    Current 
                                {% else %}
                                    Final
                                {% endif %}   
                                price: ¥{{ current.amount }} by 
                                {% if user.id != current.bidder.id %} 
                                    {{ current.bidder }}
                                {% else %} 
                                    You 
                                {% endif %}
                            </p>
                        {% endif %}
                    {% endwith %}
                    <p class="item-info">Starting price: ¥{{ item.price }}</p>
                    <p class="item-info" style="color: grey">Category: {{ item.category }} created by 
                        {% if user.id != item.name.id %} 
                            {{ item.name }} 
                        {% else %} 
                            You 
                        {% endif %}</p>
                    <p class="text">{{ item.description }}</p>
                </div>
                <div class="item-bottom-right row">
                    <div>
                    <form action="{% url 'item' item.id %}" method="post" id="form1">
                        {% csrf_token %}
                        <input type="submit" value="View" class="btn btn-primary">
                    </form>
                    </div>
                    <div>
                    <form action="{% url 'watchlist' %}" method="post" id="form2">
                        {% csrf_token %}
                        <input type="text" value="{{ item.id }}" name="item_id" hidden>
                        <input type="submit" value="Remove Watchlist" class="btn btn-secondary">
                    </form>
                    </div>
                    {% if item.closeChecker %}
                        <div id="form3">
                            <input type="submit" name="closeBid" value="Closed Bid" class="btn btn-warning" disabled>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
{% endblock %}